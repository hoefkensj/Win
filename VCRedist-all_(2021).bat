@Echo off
echo ##############################
Echo ##		VCRuntime Installer  ##
Echo ##	!By HoefkensJ@gmail.com! ##
Echo ##############################
chcp 861>nul
:: BatchGotAdmin BEGIN https://sites.google.com/site/eneerge/home/BatchGotAdmin | https://ss64.com/nt/rem.html | https://ss64.com/nt/cacls.html
:: Check for permissions
mkdir "%windir%\GotAdminTestCreateDir"
if '%errorlevel%' == '0' (
    rmdir "%windir%\GotAdminTestCreateDir" &goto gotAdmin
) else ( goto UACPrompt )
:UACPrompt
    echo Set UAC = CreateObject^("Shell.Application"^) > "%~dp0getadmin.vbs"
    echo UAC.ShellExecute "%~s0", "", "", "runas", 1 >> "%~dp0getadmin.vbs"
    "%~dp0getadmin.vbs"
    exit /B
:gotAdmin
    if exist "%~dp0getadmin.vbs" ( del "%~dp0getadmin.vbs" )
    pushd "%CD%"
    CD /D "%~dp0"
mkdir b64
del /q /f "vcredist_inst.ps1"  >nul 2>nul
del /q /f "vcredist_get.ps1"  >nul 2>nul
set "blowload1=PCMKICAgIC5TWU5PUFNJUwogICAgICAgIERvd25sb2FkIGFsbCAiZW5nbGlzaCIgVmlzdWFsIEMrKyBSdW50aW1lcwogICAgLlBBUkFNRVRFUiAgUGFyYW1ldGVyQQogICAgICAgICRPdXRwdXRQYXRoID0gRGVmYXVsdCBQYXRoCiM+CnBhcmFtKAogICAgW1N0cmluZ10kb3V0cHV0UGF0aCA9ICIuXFZDUnVudGltZSIKKQpXcml0ZS1Ib3N0ICJEb3dubG9hZCBNaWNyb3NvZnQgVmlzdWFsIEMrKyAyMDA1LCAyMDA4LCAyMDEwLCAyMDEyLCAyMDEzLCAyMDE1LDIwMTcsMjAxOSArIFZDRm9yUHl0aG9uMjciCmlmKCEgKHRlc3QtcGF0aCAiJG91dHB1dFBhdGhcVlMyMDA1WDg2U1AxIikpIHsgTmV3LUl0ZW0gIiRvdXRwdXRQYXRoXFZTMjAwNSIgLVR5cGUgZGlyZWN0b3J5IC1Gb3JjZX0KCVdyaXRlLVZlcmJvc2UgIk1pY3Jvc29mdCBWaXN1YWwgQysrIDIwMDUgU1AxIFJlZGlzdHJpYnV0YWJsZSBQYWNrYWdlICh4ODYpIiAtVmVyYm9zZQoJSW52b2tlLVdlYlJlcXVlc3QgICAiaHR0cDovL2Rvd25sb2FkLm1pY3Jvc29mdC5jb20vZG93bmxvYWQvOC9CLzQvOEI0MjI1OUYtNUQ3MC00M0Y0LUFDMkUtNEIyMDhGRDhENjZBL3ZjcmVkaXN0X3g4Ni5FWEUiIC1PdXRGaWxlICIkb3V0cHV0UGF0aFxWUzIwMDVcdmNyZWRpc3RfeDg2LmV4ZSIKCVdyaXRlLVZlcmJvc2UgIk1pY3Jvc29mdCBWaXN1YWwgQysrIDIwMDUgU1AxIFJlZGlzdHJpYnV0YWJsZSBQYWNrYWdlICh4NjQpIiAtVmVyYm9zZQoJSW52b2tlLVdlYlJlcXVlc3QgICJodHRwOi8vZG93bmxvYWQubWljcm9zb2Z0LmNvbS9kb3dubG9hZC84L0IvNC84QjQyMjU5Ri01RDcwLTQzRjQtQUMyRS00QjIwOEZEOEQ2NkEvdmNyZWRpc3RfeDY0LkVYRSIgLU91dEZpbGUgIiRvdXRwdXRQYXRoXFZTMjAwNVx2Y3JlZGlzdF94NjQuZXhlIgppZiAoISAodGVzdC1wYXRoICIkb3V0cHV0UGF0aFxWUzIwMDgiKSkgeyBOZXctSXRlbSAiJG91dHB1dFBhdGhcVlMyMDA4IiAtVHlwZSBkaXJlY3RvcnkgLUZvcmNlIH0KCVdyaXRlLVZlcmJvc2UgIk1pY3Jvc29mdCBWaXN1YWwgQysrIDIwMDggU1AxIFJlZGlzdHJpYnV0YWJsZSBQYWNrYWdlICh4ODYpIiAtVmVyYm9zZQoJSW52b2tlLVdlYlJlcXVlc3QgICJodHRwOi8vZG93bmxvYWQubWljcm9zb2Z0LmNvbS9kb3dubG9hZC81L0QvOC81RDhDNjVDQi1DODQ5LTQwMjUtOEU5NS1DMzk2NkNBRkQ4QUUvdmNyZWRpc3RfeDg2LmV4ZSIgLU91dEZpbGUgIiRvdXRwdXRQYXRoXFZTMjAwOFx2Y3JlZGlzdF94ODYuZXhlIgoJV3JpdGUtVmVyYm9zZSAiTWljcm9zb2Z0IFZpc3VhbCBDKysgMjAwOCBTUDEgUmVkaXN0cmlidXRhYmxlIFBhY2thZ2UgKHg2NCkiIC1WZXJib3NlCglJbnZva2UtV2ViUmVxdWVzdCAgImh0dHA6Ly9kb3dubG9hZC5taWNyb3NvZnQuY29tL2Rvd25sb2FkLzUvRC84LzVEOEM2NUNCLUM4NDktNDAyNS04RTk1LUMzOTY2Q0FGRDhBRS92Y3JlZGlzdF94NjQuZXhlIiAtT3V0RmlsZSAiJG91dHB1dFBhdGhcVlMyMDA4XHZjcmVkaXN0X3g2NC5leGUiCmlmICghICh0ZXN0LXBhdGggIiRvdXRwdXRQYXRoXFZTMjAxMCIpKSB7IE5ldy1JdGVtICIkb3V0cHV0UGF0aFxWUzIwMTAiIC1UeXBlIGRpcmVjdG9yeSAtRm9yY2UgfQoJV3JpdGUtVmVyYm9zZSAiTWljcm9zb2Z0IFZpc3VhbCBDKysgMjAxMCBTUDEgUmVkaXN0cmlidXRhYmxlIFBhY2thZ2UgKHg4NikiIC1WZXJib3NlCglJbnZva2UtV2ViUmVxdWVzdCAiaHR0cDovL2Rvd25sb2FkLm1pY3Jvc29mdC5jb20vZG93bmxvYWQvMS82LzUvMTY1MjU1RTctMTAxNC00RDBBLUIwOTQtQjZBNDMwQTZCRkZDL3ZjcmVkaXN0X3g4Ni5leGUiIC1PdXRGaWxlICIkb3V0cHV0UGF0aFxWUzIwMTBcdmNyZWRpc3RfeDg2LmV4ZSIKCVdyaXRlLVZlcmJvc2UgIk1pY3Jvc29mdCBWaXN1YWwgQysrIDIwMTAgU1AxIFJlZGlzdHJpYnV0YWJsZSBQYWNrYWdlICh4NjQpIiAtVmVyYm9zZQoJSW52b2tlLVdlYlJlcXVlc3QgImh0dHA6Ly9kb3dubG9hZC5taWNyb3NvZnQuY29tL2Rvd25sb2FkLzEvNi81LzE2NTI1NUU3LTEwMTQtNEQwQS1CMDk0LUI2QTQzMEE2QkZGQy92Y3JlZGlzdF94NjQuZXhlIiAtT3V0RmlsZSAiJG91dHB1dFBhdGhcVlMyMDEwXHZjcmVkaXN0X3g2NC5leGUiCmlmICghICh0ZXN0LXBhdGggIiRvdXRwdXRQYXRoXFZTMjAxMiIpKSB7IE5ldy1JdGVtICIkb3V0cHV0UGF0aFxWUzIwMTIiIC1UeXBlIGRpcmVjdG9yeSAtRm9yY2UgfQoJV3JpdGUtVmVyYm9zZSAiTWljcm9zb2Z0IFZpc3VhbCBDKysgMjAxMiBVcGRhdGUgNCBSZWRpc3RyaWJ1dGFibGUgUGFja2FnZSAoeDg2KSIgLVZlcmJvc2UKCUludm9rZS1XZWJSZXF1ZXN0ICJodHRwOi8vZG93bmxvYWQubWljcm9zb2Z0LmNvbS9kb3dubG9hZC8xLzYvQi8xNkIwNkY2MC0zQjIwLTRGRjItQjY5OS01RTlCNzk2MkY5QUUvVlNVXzQvdmNyZWRpc3RfeDg2LmV4ZSIgLU91dEZpbGUgIiRvdXRwdXRQYXRoXFZTMjAxMlx2Y3JlZGlzdF94ODYuZXhlIgoJV3JpdGUtVmVyYm9zZSAiTWljcm9zb2Z0IFZpc3VhbCBDKysgMjAxMiBVcGRhdGUgNCBSZWRpc3RyaWJ1dGFibGUgUGFja2FnZSAoeDY0KSIgLVZlcmJvc2UKCUludm9rZS1XZWJSZXF1ZXN0ICJodHRwOi8vZG93bmxvYWQubWljcm9zb2Z0LmNvbS9kb3dubG9hZC8xLzYvQi8xNkIwNkY2MC0zQjIwLTRGRjItQjY5OS01RTlCNzk2MkY5QUUvVlNVXzQvdmNyZWRpc3RfeDY0LmV4ZSIgLU91dEZpbGUgIiRvdXRwdXRQYXRoXFZTMjAxMlx2Y3JlZGlzdF94NjQuZXhlIgppZiAoISAodGVzdC1wYXRoICIkb3V0cHV0UGF0aFxWUzIwMTMiKSkgeyBOZXctSXRlbSAiJG91dHB1dFBhdGhcVlMyMDEzIiAtVHlwZSBkaXJlY3RvcnkgLUZvcmNlIH0KCVdyaXRlLVZlcmJvc2UgIk1pY3Jvc29mdCBWaXN1YWwgQysrIDIwMTMgUmVkaXN0cmlidXRhYmxlIFBhY2thZ2UgKHg4NikiIC1WZXJib3NlCglJbnZva2UtV2ViUmVxdWVzdCAiaHR0cDovL2Rvd25sb2FkLm1pY3Jvc29mdC5jb20vZG93bmxvYWQvMi9FLzYvMkU2MUNGQTQtOTkzQi00REQ0LTkxREEtMzczN0NENUNENkUzL3ZjcmVkaXN0X3g4Ni5leGUiIC1PdXRGaWxlICIkb3V0cHV0UGF0aFxWUzIwMTNcdmNyZWRpc3RfeDg2LmV4ZSIKCVdyaXRlLVZlcmJvc2UgIk1pY3Jvc29mdCBWaXN1YWwgQysrIDIwMTMgUmVkaXN0cmlidXRhYmxlIFBhY2thZ2UgKHg2NCkiIC1WZXJib3NlCglJbnZva2UtV2ViUmVxdWVzdCAiaHR0cDovL2Rvd25sb2FkLm1pY3Jvc29mdC5jb20vZG93bmxvYWQvMi9FLzYvMkU2MUNGQTQtOTkzQi00REQ0LTkxREEtMzczN0NENUNENkUzL3ZjcmVkaXN0X3g2NC5leGUiIC1PdXRGaWxlICIkb3V0cHV0UGF0aFxWUzIwMTNcdmNyZWRpc3RfeDY0LmV4ZSIKaWYgKCEgKHRlc3QtcGF0aCAiJG91dHB1dFBhdGhcVlMyMDE1IikpIHsgTmV3LUl0ZW0gIiRvdXRwdXRQYXRoXFZTMjAxNSIgLVR5cGUgZGlyZWN0b3J5IC1Gb3JjZSB9CglXcml0ZS1WZXJib3NlICJWaXN1YWwgQysrIFJlZGlzdHJpYnV0YWJsZSBmb3IgVmlzdWFsIFN0dWRpbyAyMDE1ICh4ODYpIiAtVmVyYm9zZQoJSW52b2tlLVdlYlJlcXVlc3QgImh0dHBzOi8vZG93bmxvYWQubWljcm9zb2Z0LmNvbS9kb3dubG9hZC85LzMvRi85M0ZDRjFFNy1FNkE0LTQ3OEItOTZFNy1ENEIyODU5MjVCMDAvdmNfcmVkaXN0Lng4Ni5leGUiIC1PdXRGaWxlICIkb3V0cHV0UGF0aFxWUzIwMTVcdmNyZWRpc3RfeDg2LmV4ZSIKCVdyaXRlLVZlcmJvc2UgIlZpc3VhbCBDKysgUmVkaXN0cmlidXRhYmxlIGZvciBWaXN1YWwgU3R1ZGlvIDIwMTUgKHg2NCkiIC1WZXJib3NlCglJbnZva2UtV2ViUmVxdWVzdCAiaHR0cHM6Ly9kb3dubG9hZC5taWNyb3NvZnQuY29tL2Rvd25sb2FkLzkvMy9GLzkzRkNGMUU3LUU2QTQtNDc4Qi05NkU3LUQ0QjI4NTkyNUIwMC92Y19yZWRpc3QueDY0LmV4ZSIgLU91dEZpbGUgIiRvdXRwdXRQYXRoXFZTMjAxNVx2Y3JlZGlzdF94NjQuZXhlIgppZiAoISAodGVzdC1wYXRoICIkb3V0cHV0UGF0aFxWUzIwMTciKSkgeyBOZXctSXRlbSAiJG91dHB1dFBhdGhcVlMyMDE3IiAtVHlwZSBkaXJlY3RvcnkgLUZvcmNlIH0KCVdyaXRlLVZlcmJvc2UgIlZpc3VhbCBDKysgUmVkaXN0cmlidXRhYmxlIGZvciBWaXN1YWwgU3R1ZGlvIDIwMTcgKHg4NikiIC1WZXJib3NlCglJbnZva2UtV2ViUmVxdWVzdCAiaHR0cHM6Ly9kb3dubG9hZC52aXN1YWxzdHVkaW8ubWljcm9zb2Z0LmNvbS9kb3dubG9hZC9wci8xMTEwMDIyOS83OGMxZTg2NGQ4MDZlMzZmNjAzNWQ4MGEwZTgwMzk5ZS9WQ19yZWRpc3QueDg2LmV4ZSIgLU91dEZpbGUgIiRvdXRwdXRQYXRoXFZTMjAxN1x2Y3JlZGlzdF94ODYuZXhlIgoJV3JpdGUtVmVyYm9zZSAiVmlzdWFsIEMrKyBSZWRpc3RyaWJ1dGFibGUgZm9yIFZpc3VhbCBTdHVkaW8gMjAxNyAoeDY0KSIgLVZlcmJvc2UKCUludm9rZS1XZWJSZXF1ZXN0ICJodHRwczovL2Rvd25sb2FkLnZpc3VhbHN0dWRpby5taWNyb3NvZnQuY29tL2Rvd25sb2FkL3ByLzExMTAwMjMwLzE1Y2NiM2YwMjc0NWM3YjIwNmFkMTAzNzNjYmNhODliL1ZDX3JlZGlzdC54NjQuZXhlIiAtT3V0RmlsZSAiJG91dHB1dFBhdGhcVlMyMDE3XHZjcmVkaXN0X3g2NC5leGUiCmlmICghICh0ZXN0LXBhdGggIiRvdXRwdXRQYXRoXFZTMjAxOSIpKSB7IE5ldy1JdGVtICIkb3V0cHV0UGF0aFxWUzIwMTkiIC1UeXBlIGRpcmVjdG9yeSAtRm9yY2UgfQkKCVdyaXRlLVZlcmJvc2UgIlZpc3VhbCBDKysgUmVkaXN0cmlidXRhYmxlIGZvciBWaXN1YWwgU3R1ZGlvIDIwMTkgKHg4NikiIC1WZXJib3NlCglJbnZva2UtV2ViUmVxdWVzdCAiaHR0cHM6Ly9kb3dubG9hZC52aXN1YWxzdHVkaW8ubWljcm9zb2Z0LmNvbS9kb3dubG9hZC9wci8xMTEwMDIyOS83OGMxZTg2NGQ4MDZlMzZmNjAzNWQ4MGEwZTgwMzk5ZS9WQ19yZWRpc3QueDg2LmV4ZSIgLU91dEZpbGUgIiRvdXRwdXRQYXRoXFZTMjAxOVx2Y3JlZGlzdF94ODYuZXhlIgoJV3JpdGUtVmVyYm9zZSAiVmlzdWFsIEMrKyBSZWRpc3RyaWJ1dGFibGUgZm9yIFZpc3VhbCBTdHVkaW8gMjAxOSAoeDY0KSIgLVZlcmJvc2UKCUludm9rZS1XZWJSZXF1ZXN0ICJodHRwczovL2Rvd25sb2FkLnZpc3VhbHN0dWRpby5taWNyb3NvZnQuY29tL2Rvd25sb2FkL3ByLzExMTAwMjMwLzE1Y2NiM2YwMjc0NWM3YjIwNmFkMTAzNzNjYmNhODliL1ZDX3JlZGlzdC54NjQuZXhlIiAtT3V0RmlsZSAiJG91dHB1dFBhdGhcVlMyMDE5XHZjcmVkaXN0X3g2NC5leGUiCmlmICghICh0ZXN0LXBhdGggIiRvdXRwdXRQYXRoXFZTRlAyNyIpKSB7IE5ldy1JdGVtICIkb3V0cHV0UGF0aFxWU0ZQMjciIC1UeXBlIGRpcmVjdG9yeSAtRm9yY2UgfQoJV3JpdGUtVmVyYm9zZSAiVmlzdWFsIEMrKyBSZWRpc3RyaWJ1dGFibGUgZm9yIFB5dGhvbjIuNyIgLVZlcmJvc2UKCUludm9rZS1XZWJSZXF1ZXN0ICJodHRwczovL2Rvd25sb2FkLm1pY3Jvc29mdC5jb20vZG93bmxvYWQvNy85LzYvNzk2RUYyRTQtODAxQi00RkM0LUFCMjgtQjU5RkJGNkQ5MDdCL1ZDRm9yUHl0aG9uMjcubXNpIiAtT3V0RmlsZSAiJG91dHB1dFBhdGhcVlNGUDI3XHZjcmVkaXN0X3g2NC5leGUiCgo="
set "blowload2=PCMNCiAgICAuU1lOT1BTSVMNCiAgICAgICAgSW5zdGFsbCBhbGwgImVuZ2xpc2giIFZpc3VhbCBDKysgUnVudGltZXMNCiANCiAgICAuUEFSQU1FVEVSICBQYXJhbWV0ZXJBDQogICAgICAgICRPdXRwdXRQYXRoID0gRGVmYXVsdCBQYXRoDQojPiAgDQpwYXJhbSgNCiAgICBbU3RyaW5nXSRvdXRwdXRQYXRoID0gIi5cVkNSdW50aW1lIg0KKQ0KIA0KW1N0cmluZ10kb3V0cHV0UGF0aCA9ICIuXFZDUnVudGltZSINCiANCldyaXRlLUhvc3QgIkluc3RhbGwgTWljcm9zb2Z0IFZpc3VhbCBDKysgMjAwNSwgMjAwOCwgMjAxMCwgMjAxMiwgMjAxMywgMjAxNSwyMDE3LDIwMTkgKyBWQ0ZvclB5dGhvbjIuNyINCg0KIA0KZm9yZWFjaCAoJHZjRmlsZSBpbiBHZXQtQ2hpbGRJdGVtICRvdXRwdXRQYXRoIC1SZWN1cnNlIC1GaWx0ZXIgIiouZXhlIikNCnsNCiAgICBXcml0ZS1Ib3N0ICJJbnN0YWxsICIgJHZjRmlsZS5mdWxsbmFtZQ0KICAgIFN0YXJ0LVByb2Nlc3MgICR2Y0ZpbGUuZnVsbG5hbWUgLUFyZ3VtZW50TGlzdCAnL3EnIC1Ob05ld1dpbmRvdyAtV2FpdA0KICAgICANCiAgICAgDQp9DQpmb3JlYWNoICgkdmNGaWxlIGluIEdldC1DaGlsZEl0ZW0gJG91dHB1dFBhdGggLVJlY3Vyc2UgLUZpbHRlciAiKi5tc2kiKQ0Kew0KICAgIFdyaXRlLUhvc3QgIkluc3RhbGwgIiAkdmNGaWxlLmZ1bGxuYW1lDQogICAgU3RhcnQtUHJvY2VzcyAgJHZjRmlsZS5mdWxsbmFtZSAtQXJndW1lbnRMaXN0ICcvcScgLU5vTmV3V2luZG93IC1XYWl0DQogICAgIA0KICAgICANCn0="
echo -----BEGIN CERTIFICATE-----%blowload1%-----END CERTIFICATE----->"b64\b64_1"
certutil /decode "b64\b64_1" "vcredist_get.ps1" >nul 2>nul
echo -----BEGIN CERTIFICATE-----%blowload2%-----END CERTIFICATE----->"b64\b64_2"
certutil /decode "b64\b64_2" "vcredist_inst.ps1" >nul 2>nul
start /wait powershell.exe -file vcredist_get.ps1
start /wait powershell.exe -file vcredist_inst.ps1
rmdir /S b64 >nul 2>nul
PAUSE
